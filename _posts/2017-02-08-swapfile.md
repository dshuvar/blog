---
published: false
---
## Управление размером swap-файла

Вчера на работе попросили написать небольшую инструкцию для увеличения swap-файла, но размер файл можно как увеличивать так и уменьшать в случае необходимости. Информация в заметке актуальна для ubuntu версий 14 и 16 а также centos 7.

Во многих ОС swap представлен не в виду отдельного раздела на диске, а в виде файла. Зачустую файл расположен в рутовой директории `/swap`. В случае отсутсвия такого файла его всегда можно создать.

Для изменения размера swap требуются следующие действия:

Сравнить размер swap файла и текущий размер swap:

```
free -m
              total        used        free      shared  buff/cache   available
Mem:            992          29         883           3          79         845
Swap:           511           0         511

ls -laht /swap 
-rw-r--r-- 1 root root 512M Nov 28 09:25 /swap
```

Отключить swap

`swapoff -a`

Изменить размер swap-файла

`sudo dd if=/dev/zero of=/swap bs=1M count=1024`


где count есть желаемый размер, например 512 или 1024 или 4096.

Подготовить swap-файл

`chmod 600 /swap && mkswap /swap`

Включить swap

`swapon /swap`

Проверяем результат:

```
free -m
              total        used        free      shared  buff/cache   available
Mem:            992          29          81           3         880         805
Swap:          1023           0        1023

ls -laht /swap 
-rw------- 1 root root 1.0G Feb  7 13:14 /swap
```

