---
published: false
categories: work
date: '2017-03-30 16:43:00 +0300'
---
###Sar - system actiity report
`sar` - утилита, распространаяющаяся с пакетом sysstat, собирающая информацию о системной активности.

Благодаря отчетам сгенерированным утилитой `sar` можно много узнать о производительности вашей системы.

Главный конфигурационный файл для утилиты может находится тут: `/etc/sysconfig/sysstat` или тут: `/etc/sysstat/sysstat`

Основной директивы для конфига следующие:

```
history=7 `# указывает сколько дней будут хранится лог-файлы`
SA_DIR=/var/log/sysstat `# Указывает директорию для хранений лог-файлов`
```

Основной синтаксис утилиты таков:

`sar -REPORT LEN CNT`

синтаксис включает в себя опции:

`REPORT` - однобуквенная опция, указывающая какой отчет запускать, самые часто используемые опции:
`-u` отчет использования CPU.
`-b` отчет использования I/O.
`-d` отчет использования дисков.

`LEN` - опция сообщает утилите через какое колво времени наблюдать за активностью системы в секундах.

`CNT` - опция сообщает утилите сколько раз повторять наблюдения и создание отчетов, если его не указывать то процесс будет продолжаться до тех пор, пока не будет остановлен.

Например:

```
sar -u 5 4
Linux 4.4.0-46-generic (home) 	10.04.2017 	_x86_64_	(2 CPU)

00:47:41        CPU     %user     %nice   %system   %iowait    %steal     %idle
00:47:46        all     44,56      0,80      3,60      0,40      0,00     50,65
00:47:51        all     34,87      1,08      6,56      1,27      0,00     56,22
00:47:56        all     44,05      0,88      3,83      0,20      0,00     51,03
00:48:01        all     28,46      1,00      3,61      0,50      0,00     66,43
Average:        all     38,00      0,94      4,41      0,59      0,00     56,06
```
В указанном листинге показано, что утилита выполнила 4 проверки через каждые 5 секунд.

%user - процент утилизации CPU исполняемыми пользовательскими процессами, например приложениями.
%nice - процент утилизации CPU исполняемыми процессами с учетом их приоритетов.
%system - процент утилизации CPU системными процессами, например ядром.
%iowait - процент времени в течении которого CPU простаивал в ожидании ввода/вывода.
%steal - процент времени, затраченного на принудительное ожидание виртуальным процессором или процессорами, в то время как гипервизор обслуживал другой виртуальный процессор.
%idle - процент времени в течении которого CPU простаивал и не имел запросов ввода/вывода.

```
sar -b 5
Linux 4.4.0-46-generic (home) 	10.04.2017 	_x86_64_	(2 CPU)

02:58:59          tps      rtps      wtps   bread/s   bwrtn/s
02:59:04         0,40      0,00      0,40      0,00     24,00
02:59:09         6,60      0,00      6,60      0,00   1097,60
02:59:14         2,40      0,00      2,40      0,00    329,60
02:59:19         3,40      0,00      3,40      0,00    267,20
02:59:24         2,00      0,20      1,80      1,60    976,00
02:59:29        10,20      0,00     10,20      0,00    152,00
02:59:34         1,00      0,00      1,00      0,00     27,20
02:59:39         3,20      0,00      3,20      0,00    819,20
02:59:44         1,80      1,40      0,40    112,00     25,60
02:59:49         5,40      0,20      5,20      1,60    392,00
^C

Average:         3,64      0,18      3,46     11,52    411,04
```
В указанном листинге показано, что утилита выполняла проверки, до получения сигнала 'прерывания' SIGINT.

tps - общее колво запросов в секунду к дисковой подсистеме.
rtps - колво запросов в секунду на чтение дисковой подсистеме.
wtps - колво запросов в секунду на запись дисковой подсистеме.
bread/s
bwrtn/s